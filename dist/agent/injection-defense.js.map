{"version":3,"file":"injection-defense.js","sourceRoot":"","sources":["../../src/agent/injection-defense.ts"],"names":[],"mappings":"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"}